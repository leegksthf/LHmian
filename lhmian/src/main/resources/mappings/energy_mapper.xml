<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lh.app.energy.mapper.EnergyMapper">
<select id="getList" resultType="EnergyVO">
SELECT MF_DATE,
		HOUSE_INFO,
		ENG,
		GAS,
		ELECTRIC,
		WATER,
		TRASH,
		TRASH_FOOD
	FROM
		ENERGY_USAGE
		WHERE HOUSE_INFO = #{houseInfo}
		<!-- <if test="mfDate eq 6"> -->
        AND MF_DATE BETWEEN TRUNC(TO_CHAR(ADD_MONTHS(SYSDATE,-5), 'YYMM')) AND TO_CHAR(SYSDATE,'YYMM')
		<!-- </if>
		<if test="mfDate eq 12">
        AND MF_DATE BETWEEN TRUNC(TO_CHAR(ADD_MONTHS(SYSDATE,-11), 'YYMM')) AND TO_CHAR(SYSDATE,'YYMM')
		</if> -->
		ORDER BY MF_DATE
</select>

<select id="read" resultType="EnergyVO" parameterType="EnergyVO">
	SELECT MF_DATE,
		HOUSE_INFO,
		ENG,
		GAS,
		ELECTRIC,
		WATER,
		TRASH,
		TRASH_FOOD
	FROM
		ENERGY_USAGE
	WHERE MF_DATE = (SELECT MAX(MF_DATE) FROM ENERGY_USAGE)
	AND HOUSE_INFO = #{houseInfo}
	ORDER BY MF_DATE
</select>
</mapper>